{"ast":null,"code":"import _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport React from \"react\";\nimport { Link, TextField, Checkbox, Button, RadioButton, Stack, Heading, Page } from '@shopify/polaris';\nimport store from 'store-js';\nimport Cookies from 'js-cookie';\nimport '../stylesheets/settings.css';\n\nvar Coupons =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Coupons, _React$Component);\n\n  function Coupons() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Coupons);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Coupons)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      discounts: [],\n      value: 0,\n      fixed_type: true\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"componentDidMount\", function () {\n      fetch('https://app.trytada.com/getDiscounts', {\n        method: 'POST',\n        headers: {\n          'Content-type': 'application/json'\n        },\n        body: _JSON$stringify({\n          id: Cookies.get('widget_id')\n        })\n      }).then(function (resp) {\n        return resp.json();\n      }).then(function (json) {\n        if (json.error) {\n          console.log('error');\n          return;\n        }\n\n        var discounts = JSON.parse(json);\n\n        _this.setState({\n          discounts: discounts\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleType\", function (value) {\n      _this.setState({\n        fixed_type: value\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"valueChange\", function () {\n      return function (value) {\n        _this.setState({\n          value: value\n        });\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"nextStep\", function () {\n      window.location.href = '/style';\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"deleteCoupon\", function (key) {\n      var discounts = _this.state.discounts;\n      delete discounts[key];\n      fetch('https://app.trytada.com/updateCoupon', {\n        method: 'POST',\n        headers: {\n          'Content-type': 'application/json'\n        },\n        body: _JSON$stringify({\n          discounts: discounts,\n          id: Cookies.get('widget_id')\n        })\n      });\n\n      _this.setState({\n        discounts: discounts\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"addCoupon\", function () {\n      var _this$state = _this.state,\n          fixed_type = _this$state.fixed_type,\n          value = _this$state.value;\n      var discounts = _this.state.discounts;\n      var discount = {\n        enable: true,\n        type: fixed_type ? 'fixed_amount' : 'percentage',\n        value: value\n      };\n      var key = 'discount' + value;\n      var title = ' Discount';\n\n      if (fixed_type) {\n        key += 'f';\n        title = '$' + value + title;\n      } else {\n        key += 'p';\n        title = value + '%' + title;\n      }\n\n      discount.title = title;\n      discounts[key] = discount;\n      fetch('https://app.trytada.com/updateCoupon', {\n        method: 'POST',\n        headers: {\n          'Content-type': 'application/json',\n          id: Cookies.get('widget_id')\n        },\n        body: _JSON$stringify({\n          discounts: discounts\n        })\n      });\n\n      _this.setState({\n        discounts: discounts,\n        fixed_type: true,\n        value: 0\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"changeEnable\", function (field) {\n      return function (checked) {\n        var discounts = _this.state.discounts;\n        discounts[field].enable = checked;\n\n        _this.setState({\n          discounts: discounts\n        });\n      };\n    });\n\n    return _this;\n  }\n\n  _createClass(Coupons, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var discounts = this.state.discounts;\n      return React.createElement(Page, {\n        title: \"What discounts do you want to offer?\"\n      }, React.createElement(\"div\", {\n        className: \"discount-setting\"\n      }, React.createElement(Checkbox, {\n        checked: this.state.discounts.freeshipping.enable,\n        label: \"Free Shipping\",\n        onChange: this.changeEnable('freeshipping')\n      }), React.createElement(Checkbox, {\n        checked: this.state.discounts.discount15p.enable,\n        label: \"15% Discount\",\n        onChange: this.changeEnable('discount15p')\n      }), React.createElement(Checkbox, {\n        checked: this.state.discounts.discount25p.enable,\n        label: \"25% Discount\",\n        onChange: this.changeEnable('discount25p')\n      }), React.createElement(Button, {\n        onClick: function onClick() {\n          return _this2.nextStep();\n        },\n        primary: true\n      }, \"Next Step\")), React.createElement(\"div\", null, React.createElement(TextField, {\n        value: this.state.value,\n        onChange: this.valueChange(),\n        label: \"\",\n        type: \"number\"\n      }), React.createElement(Stack, {\n        horizontal: true\n      }, React.createElement(RadioButton, {\n        label: \"$ Off\",\n        id: \"fixed_amount\",\n        name: \"fixed_amount\",\n        onChange: this.handleType(true),\n        checked: this.state.fixed_type\n      }), React.createElement(RadioButton, {\n        label: \"$ Off\",\n        id: \"percentage\",\n        name: \"percentage\",\n        onChange: this.handleType(false),\n        checked: !this.state.fixed_type\n      })), React.createElement(Button, {\n        type: \"button\",\n        onClick: function onClick() {\n          return _this2.addCoupon();\n        },\n        primary: true\n      }, \"Add\")), React.createElement(Stack, {\n        vertical: true\n      }, _Object$keys(discounts).map(function (key) {\n        if (key != 'freeshipping' && key != 'discount15p' && key != 'discount25p') {\n          React.createElement(\"div\", null, React.createElement(\"span\", null, discount.title), React.createElement(\"button\", {\n            onClick: function onClick() {\n              return _this2.deleteCoupon(key);\n            },\n            type: \"button\"\n          }, \"Delete\"));\n        }\n      })), React.createElement(Stack, {\n        horizontal: true\n      }, React.createElement(Button, {\n        primary: true,\n        onClick: function onClick() {\n          return _this2.nextStep();\n        }\n      }, \"Next Step\")));\n    }\n  }]);\n\n  return Coupons;\n}(React.Component);\n\nexport default Coupons;","map":{"version":3,"sources":["/Users/dev/Documents/Git/tadaShopify/pages/coupons.js"],"names":["Link","TextField","Checkbox","Button","RadioButton","Stack","Heading","Page","store","Cookies","Coupons","discounts","value","fixed_type","fetch","method","headers","body","id","get","then","resp","json","error","console","log","JSON","parse","setState","window","location","href","key","state","discount","enable","type","title","field","checked","freeshipping","changeEnable","discount15p","discount25p","nextStep","valueChange","handleType","addCoupon","map","deleteCoupon","React","Component"],"mappings":"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","sourcesContent":["import { Link, TextField, Checkbox, Button, RadioButton, Stack, Heading, Page } from '@shopify/polaris';\nimport store from 'store-js';\nimport Cookies from 'js-cookie';\nimport '../stylesheets/settings.css';\n\nclass Coupons extends React.Component {\n  state = { discounts: [], value: 0, fixed_type: true };\n\n  componentDidMount = () => {\n    fetch('https://app.trytada.com/getDiscounts', {\n        method: 'POST',\n        headers: {\n            'Content-type': 'application/json'\n        },\n        body: JSON.stringify({\n            id: Cookies.get('widget_id')\n        })\n    }).then(resp => resp.json())\n    .then(json => {\n        if(json.error) {\n            console.log('error');\n            return;\n        }\n        var discounts = JSON.parse(json);\n        this.setState({\n            discounts\n        })\n    })\n  }\n\n  render() {\n      const { discounts } = this.state;\n    return (\n      <Page\n        title=\"What discounts do you want to offer?\"\n      >\n        <div className=\"discount-setting\">\n            <Checkbox checked={this.state.discounts.freeshipping.enable} label=\"Free Shipping\" onChange={this.changeEnable('freeshipping')} />\n            <Checkbox checked={this.state.discounts.discount15p.enable} label=\"15% Discount\" onChange={this.changeEnable('discount15p')} />\n            <Checkbox checked={this.state.discounts.discount25p.enable} label=\"25% Discount\" onChange={this.changeEnable('discount25p')} />\n            <Button onClick={() => this.nextStep()} primary>Next Step</Button>\n        </div>\n        <div>\n            <TextField value={this.state.value} onChange={this.valueChange()} label=\"\" type=\"number\" />\n            <Stack horizontal>\n              <RadioButton label=\"$ Off\" id=\"fixed_amount\" name=\"fixed_amount\" onChange={this.handleType(true)} checked={this.state.fixed_type} />\n              <RadioButton label=\"$ Off\" id=\"percentage\" name=\"percentage\" onChange={this.handleType(false)} checked={!this.state.fixed_type} />\n            </Stack>\n            <Button type=\"button\" onClick={() => this.addCoupon()} primary>Add</Button>\n        </div>\n        <Stack vertical>\n            { Object.keys(discounts).map(key => {\n                if(key != 'freeshipping' && key != 'discount15p' && key != 'discount25p') {\n                    <div>\n                        <span>{discount.title}</span>\n                        <button onClick={() => this.deleteCoupon(key)} type=\"button\">Delete</button>\n                    </div>\n                }\n            })}\n        </Stack>\n        <Stack horizontal>\n            <Button primary onClick={() => this.nextStep()}>Next Step</Button>\n        </Stack>\n    </Page>\n    )\n  }\n\n  handleType = (value) => {\n      this.setState({\n          fixed_type: value\n      });\n  }\n\n  valueChange = () => {\n      return (value) => {\n            this.setState({\n                value: value\n            })\n      }\n  }\n\n  nextStep = () => {\n      window.location.href = '/style';\n  }\n\n  deleteCoupon = (key) =>{\n      var {discounts} = this.state;\n      delete discounts[key];\n\n      fetch('https://app.trytada.com/updateCoupon', {\n          method: 'POST',\n          headers: {\n              'Content-type': 'application/json'\n          },\n          body: JSON.stringify({\n              discounts,\n              id: Cookies.get('widget_id')\n          })\n      })\n      this.setState({\n          discounts\n      })\n  }\n\n  addCoupon = () => {\n      const {fixed_type , value} = this.state;\n      var {discounts} = this.state;\n      var discount = {\n            enable: true,\n            type: fixed_type?'fixed_amount': 'percentage',\n            value: value\n      };\n      var key = 'discount' + value;\n      var title = ' Discount';\n      if(fixed_type) {\n          key += 'f';\n          title = '$' + value + title;\n      } else {\n          key += 'p'\n          title = value + '%' + title;\n      }\n      discount.title = title;\n      discounts[key] = discount;\n      fetch('https://app.trytada.com/updateCoupon', {\n        method: 'POST',\n        headers: {\n            'Content-type': 'application/json',\n            id: Cookies.get('widget_id')\n        },\n        body: JSON.stringify({\n            discounts\n        })\n      })\n      this.setState({\n          discounts,\n          fixed_type: true,\n          value: 0\n      });\n  }\n\n  changeEnable = (field) => {\n      return (checked) => {\n          var {discounts} = this.state;\n          discounts[field].enable = checked;\n          this.setState({\n              discounts: discounts\n          });\n      }\n  }\n}\n\nexport default Coupons;"]},"metadata":{},"sourceType":"module"}